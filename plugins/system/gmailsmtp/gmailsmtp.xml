<?xml version="1.0" encoding="utf-8"?>
<extension type="plugin" group="system" method="upgrade">
    <name>plg_system_gmailsmtp</name>
    <author>Modern Designs</author>
    <creationDate>2025-12-01</creationDate>
    <copyright>(C) 2025 Modern Designs</copyright>
    <license>GNU General Public License version 2 or later</license>
    <authorEmail>support@moderndesigns.com</authorEmail>
    <authorUrl>https://www.moderndesigns.com</authorUrl>
    <version>1.0.0</version>
    <description>PLG_SYSTEM_GMAILSMTP_XML_DESCRIPTION</description>
    <namespace path="src">Joomla\Plugin\System\GmailSmtp</namespace>

    <files>
        <folder plugin="gmailsmtp">services</folder>
        <folder>src</folder>
        <folder>sql</folder>
        <folder>language</folder>
    </files>

    <languages folder="language">
        <language tag="en-GB">en-GB/plg_system_gmailsmtp.ini</language>
        <language tag="en-GB">en-GB/plg_system_gmailsmtp.sys.ini</language>
    </languages>

    <install>
        <sql>
            <file driver="mysql" charset="utf8">sql/install.mysql.sql</file>
        </sql>
    </install>

    <uninstall>
        <sql>
            <file driver="mysql" charset="utf8">sql/uninstall.mysql.sql</file>
        </sql>
    </uninstall>

    <updateservers>
        <server type="extension" name="Gmail SMTP OAuth Updates">https://moderndesigns.studio/updates/gmail-smtp-oauth?format=xml</server>
    </updateservers>

    <config>
        <fields name="params">
            <fieldset name="basic" label="PLG_SYSTEM_GMAILSMTP_FIELDSET_BASIC"
                addfieldprefix="Joomla\Plugin\System\GmailSmtp\Field">

                <field
                    name="setup_instructions"
                    type="note"
                    label="PLG_SYSTEM_GMAILSMTP_SETUP_INSTRUCTIONS_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_SETUP_INSTRUCTIONS_DESC"
                    class="alert alert-info"
                />

                <field
                    name="connection_status"
                    type="GmailStatus"
                    label="PLG_SYSTEM_GMAILSMTP_CONNECTION_STATUS_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_CONNECTION_STATUS_DESC"
                />

                <field
                    name="client_id"
                    type="text"
                    label="PLG_SYSTEM_GMAILSMTP_CLIENT_ID_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_CLIENT_ID_DESC"
                    required="true"
                    size="80"
                    filter="string"
                />

                <field
                    name="client_secret"
                    type="password"
                    label="PLG_SYSTEM_GMAILSMTP_CLIENT_SECRET_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_CLIENT_SECRET_DESC"
                    required="true"
                    size="60"
                    filter="raw"
                    autocomplete="new-password"
                />

                <field
                    name="redirect_uri"
                    type="GmailRedirectUri"
                    label="PLG_SYSTEM_GMAILSMTP_REDIRECT_URI_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_REDIRECT_URI_DESC"
                    readonly="true"
                />

                <field
                    name="authorize_button"
                    type="GmailAuthorize"
                    label="PLG_SYSTEM_GMAILSMTP_AUTHORIZE_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_AUTHORIZE_DESC"
                />

            </fieldset>

            <fieldset name="sender" label="PLG_SYSTEM_GMAILSMTP_FIELDSET_SENDER">

                <field
                    name="from_email"
                    type="email"
                    label="PLG_SYSTEM_GMAILSMTP_FROM_EMAIL_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_FROM_EMAIL_DESC"
                    filter="email"
                    size="50"
                    hint="your-email@gmail.com"
                />

                <field
                    name="from_name"
                    type="text"
                    label="PLG_SYSTEM_GMAILSMTP_FROM_NAME_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_FROM_NAME_DESC"
                    filter="string"
                    size="50"
                />

            </fieldset>

            <fieldset name="testing" label="PLG_SYSTEM_GMAILSMTP_FIELDSET_TESTING"
                addfieldprefix="Joomla\Plugin\System\GmailSmtp\Field">

                <field
                    name="test_email"
                    type="GmailTestEmail"
                    label="PLG_SYSTEM_GMAILSMTP_TEST_EMAIL_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_TEST_EMAIL_DESC"
                />

                <field
                    name="debug_mode"
                    type="radio"
                    label="PLG_SYSTEM_GMAILSMTP_DEBUG_MODE_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_DEBUG_MODE_DESC"
                    default="0"
                    class="btn-group btn-group-yesno"
                >
                    <option value="0">JNO</option>
                    <option value="1">JYES</option>
                </field>

            </fieldset>

            <fieldset name="description" label="PLG_SYSTEM_GMAILSMTP_FIELDSET_DESCRIPTION">

                <field
                    name="how_it_works"
                    type="note"
                    label="PLG_SYSTEM_GMAILSMTP_HOW_IT_WORKS_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_HOW_IT_WORKS_DESC"
                    class="alert alert-info"
                />

                <field
                    name="important_notes"
                    type="note"
                    label="PLG_SYSTEM_GMAILSMTP_IMPORTANT_NOTES_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_IMPORTANT_NOTES_DESC"
                    class="alert alert-warning"
                />

                <field
                    name="security_info"
                    type="note"
                    label="PLG_SYSTEM_GMAILSMTP_SECURITY_INFO_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_SECURITY_INFO_DESC"
                    class="alert alert-success"
                />

                <field
                    name="troubleshooting"
                    type="note"
                    label="PLG_SYSTEM_GMAILSMTP_TROUBLESHOOTING_LABEL"
                    description="PLG_SYSTEM_GMAILSMTP_TROUBLESHOOTING_DESC"
                    class="alert alert-secondary"
                />

            </fieldset>

        </fields>
    </config>
</extension>
